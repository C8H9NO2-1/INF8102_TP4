{
  "SchemaVersion": 2,
  "CreatedAt": "2025-12-01T08:41:03.2718783-05:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Metadata": {
    "RepoURL": "https://github.com/C8H9NO2-1/INF8102_TP4.git",
    "Branch": "main",
    "Commit": "912dc9a017c0c9ca48f628eae2e25508690aac0f",
    "CommitMsg": "adding the policy and CloudTrail resource",
    "Author": "Paracetamol \u003cparacetamol.C8H9NO2@icloud.com\u003e",
    "Committer": "Paracetamol \u003cparacetamol.C8H9NO2@icloud.com\u003e"
  },
  "Results": [
    {
      "Target": "ec2-priv-AZ1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2-priv-AZ1.json:5-25",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "            \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "            \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "                \"KeyName\": \"polystudent-pair\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"KeyName\"\u001b[0m: \u001b[38;5;37m\"polystudent-pair\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "                \"InstanceType\": \"t2.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t2.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "                \"ImageId\": \"ami-09e7fb5d565f22127\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-09e7fb5d565f22127\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "                \"AvailabilityZone\": \"ca-central-1a\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"AvailabilityZone\"\u001b[0m: \u001b[38;5;37m\"ca-central-1a\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "                \"SecurityGroupIds\": [\"sg-0cd470b2de09bfad4\"],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [\u001b[38;5;37m\"sg-0cd470b2de09bfad4\"\u001b[0m],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "                \"SubnetId\": \"subnet-0bb33811af471ec41\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SubnetId\"\u001b[0m: \u001b[38;5;37m\"subnet-0bb33811af471ec41\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "                    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "                        \"DeviceName\": \"/dev/sda1\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"DeviceName\"\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "                        \"Ebs\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"Ebs\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "                            \"DeleteOnTermination\": \"false\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"DeleteOnTermination\"\u001b[0m: \u001b[38;5;37m\"false\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "                            \"VolumeSize\": \"80\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"VolumeSize\"\u001b[0m: \u001b[38;5;37m\"80\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "                        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                        }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "                    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "ec2-priv-AZ1.json",
                "Location": {
                  "StartLine": 5,
                  "EndLine": 25
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "ec2-priv-AZ2.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2-priv-AZ2.json:5-25",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "            \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "            \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "                \"KeyName\": \"polystudent-pair\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"KeyName\"\u001b[0m: \u001b[38;5;37m\"polystudent-pair\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "                \"InstanceType\": \"t2.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t2.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "                \"ImageId\": \"ami-09e7fb5d565f22127\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-09e7fb5d565f22127\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "                \"AvailabilityZone\": \"ca-central-1b\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"AvailabilityZone\"\u001b[0m: \u001b[38;5;37m\"ca-central-1b\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "                \"SecurityGroupIds\": [\"sg-0cd470b2de09bfad4\"],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [\u001b[38;5;37m\"sg-0cd470b2de09bfad4\"\u001b[0m],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "                \"SubnetId\": \"subnet-0d9c22864546c82f0\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SubnetId\"\u001b[0m: \u001b[38;5;37m\"subnet-0d9c22864546c82f0\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "                    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "                        \"DeviceName\": \"/dev/sda1\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"DeviceName\"\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "                        \"Ebs\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"Ebs\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "                            \"DeleteOnTermination\": \"false\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"DeleteOnTermination\"\u001b[0m: \u001b[38;5;37m\"false\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "                            \"VolumeSize\": \"80\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"VolumeSize\"\u001b[0m: \u001b[38;5;37m\"80\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "                        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                        }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "                    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "ec2-priv-AZ2.json",
                "Location": {
                  "StartLine": 5,
                  "EndLine": 25
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "ec2-pub-AZ1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2-pub-AZ1.json:5-25",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "            \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "            \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "                \"KeyName\": \"polystudent-pair\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"KeyName\"\u001b[0m: \u001b[38;5;37m\"polystudent-pair\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "                \"InstanceType\": \"t2.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t2.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "                \"ImageId\": \"ami-09e7fb5d565f22127\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-09e7fb5d565f22127\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "                \"AvailabilityZone\": \"ca-central-1a\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"AvailabilityZone\"\u001b[0m: \u001b[38;5;37m\"ca-central-1a\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "                \"SecurityGroupIds\": [\"sg-0cd470b2de09bfad4\"],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [\u001b[38;5;37m\"sg-0cd470b2de09bfad4\"\u001b[0m],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "                \"SubnetId\": \"subnet-083938fe0f1392d10\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SubnetId\"\u001b[0m: \u001b[38;5;37m\"subnet-083938fe0f1392d10\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "                    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "                        \"DeviceName\": \"/dev/sda1\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"DeviceName\"\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "                        \"Ebs\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"Ebs\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "                            \"DeleteOnTermination\": \"false\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"DeleteOnTermination\"\u001b[0m: \u001b[38;5;37m\"false\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "                            \"VolumeSize\": \"80\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"VolumeSize\"\u001b[0m: \u001b[38;5;37m\"80\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "                        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                        }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "                    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "ec2-pub-AZ1.json",
                "Location": {
                  "StartLine": 5,
                  "EndLine": 25
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "ec2-pub-AZ2.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2-pub-AZ2.json:5-25",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "            \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "            \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "                \"KeyName\": \"polystudent-pair\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"KeyName\"\u001b[0m: \u001b[38;5;37m\"polystudent-pair\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "                \"InstanceType\": \"t2.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t2.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "                \"ImageId\": \"ami-09e7fb5d565f22127\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-09e7fb5d565f22127\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "                \"AvailabilityZone\": \"ca-central-1b\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"AvailabilityZone\"\u001b[0m: \u001b[38;5;37m\"ca-central-1b\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "                \"SecurityGroupIds\": [\"sg-0cd470b2de09bfad4\"],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [\u001b[38;5;37m\"sg-0cd470b2de09bfad4\"\u001b[0m],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "                \"SubnetId\": \"subnet-03333732baad11622\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SubnetId\"\u001b[0m: \u001b[38;5;37m\"subnet-03333732baad11622\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "                    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "                        \"DeviceName\": \"/dev/sda1\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"DeviceName\"\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "                        \"Ebs\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"Ebs\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "                            \"DeleteOnTermination\": \"false\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"DeleteOnTermination\"\u001b[0m: \u001b[38;5;37m\"false\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "                            \"VolumeSize\": \"80\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"VolumeSize\"\u001b[0m: \u001b[38;5;37m\"80\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "                        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                        }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "                    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "ec2-pub-AZ2.json",
                "Location": {
                  "StartLine": 5,
                  "EndLine": 25
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "ec2.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 2
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0028",
          "AVDID": "AVD-AWS-0028",
          "Title": "aws_instance should activate session tokens for Instance Metadata Service.",
          "Description": "IMDS v2 (Instance Metadata Service) introduced session authentication tokens which improve security when talking to IMDS.\n\nBy default \u003ccode\u003eaws_instance\u003c/code\u003e resource sets IMDS session auth tokens to be optional.\n\nTo fully protect IMDS you need to enable session tokens by using \u003ccode\u003emetadata_options\u003c/code\u003e block and its \u003ccode\u003ehttp_tokens\u003c/code\u003e variable set to \u003ccode\u003erequired\u003c/code\u003e.\n",
          "Message": "Instance does not require IMDS access to require a token.",
          "Namespace": "builtin.aws.ec2.aws0028",
          "Query": "data.builtin.aws.ec2.aws0028.deny",
          "Resolution": "Enable HTTP token requirement for IMDS",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0028",
          "References": [
            "https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service",
            "https://avd.aquasec.com/misconfig/avd-aws-0028"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "ec2.json:5-25",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 5,
            "EndLine": 25,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "            \"Type\": \"AWS::EC2::Instance\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m: \u001b[38;5;37m\"AWS::EC2::Instance\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 7,
                  "Content": "            \"Properties\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 8,
                  "Content": "                \"KeyName\": \"polystudent-pair\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"KeyName\"\u001b[0m: \u001b[38;5;37m\"polystudent-pair\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 9,
                  "Content": "                \"InstanceType\": \"t3.micro\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"InstanceType\"\u001b[0m: \u001b[38;5;37m\"t3.micro\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 10,
                  "Content": "                \"ImageId\": \"ami-0abac8735a38475db\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"ImageId\"\u001b[0m: \u001b[38;5;37m\"ami-0abac8735a38475db\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 11,
                  "Content": "                \"AvailabilityZone\": \"ca-central-1a\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"AvailabilityZone\"\u001b[0m: \u001b[38;5;37m\"ca-central-1a\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 12,
                  "Content": "                \"SecurityGroupIds\": [\"sg-06ebd00a91bd21e63\"],",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SecurityGroupIds\"\u001b[0m: [\u001b[38;5;37m\"sg-06ebd00a91bd21e63\"\u001b[0m],",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 13,
                  "Content": "                \"SubnetId\": \"subnet-03d75168ecc5691fb\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"SubnetId\"\u001b[0m: \u001b[38;5;37m\"subnet-03d75168ecc5691fb\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 14,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0131",
          "AVDID": "AVD-AWS-0131",
          "Title": "Instance with unencrypted block device.",
          "Description": "Block devices should be encrypted to ensure sensitive data is held securely at rest.\n",
          "Message": "Root block device is not encrypted.",
          "Namespace": "builtin.aws.ec2.aws0131",
          "Query": "data.builtin.aws.ec2.aws0131.deny",
          "Resolution": "Turn on encryption for all block devices",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0131",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0131"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "EC2Instance",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 16,
            "EndLine": 22,
            "Code": {
              "Lines": [
                {
                  "Number": 5,
                  "Content": "        \"EC2Instance\": {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"EC2Instance\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 6,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "                    {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 17,
                  "Content": "                        \"DeviceName\": \"/dev/sda1\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"DeviceName\"\u001b[0m: \u001b[38;5;37m\"/dev/sda1\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 18,
                  "Content": "                        \"Ebs\": {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                        \u001b[38;5;33m\"Ebs\"\u001b[0m: {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "                            \"DeleteOnTermination\": \"false\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"DeleteOnTermination\"\u001b[0m: \u001b[38;5;37m\"false\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "                            \"VolumeSize\": \"80\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                            \u001b[38;5;33m\"VolumeSize\"\u001b[0m: \u001b[38;5;37m\"80\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "                        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m                        }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "                    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                    }",
                  "FirstCause": false,
                  "LastCause": true
                },
                {
                  "Number": 24,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "EC2Instance",
                "Filename": "ec2.json",
                "Location": {
                  "StartLine": 5,
                  "EndLine": 25
                }
              }
            ]
          }
        }
      ]
    },
    {
      "Target": "s3-2-backup.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 47,
        "Failures": 0
      }
    },
    {
      "Target": "s3-2.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 48,
        "Failures": 3
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0014",
          "AVDID": "AVD-AWS-0014",
          "Title": "Cloudtrail should be enabled in all regions regardless of where your AWS resources are generally homed",
          "Description": "Activity could be happening in your account in a different region. When creating Cloudtrail in the AWS Management Console the trail is configured by default to be multi-region, this isn't the case with the Terraform resource. Cloudtrail should cover the full AWS account to ensure you can track changes in regions you are not actively operating in.\n",
          "Message": "Trail is not enabled across all regions.",
          "Namespace": "builtin.aws.cloudtrail.aws0014",
          "Query": "data.builtin.aws.cloudtrail.aws0014.deny",
          "Resolution": "Enable Cloudtrail in all regions",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0014",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/receive-cloudtrail-log-files-from-multiple-regions.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0014"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3-2.json:102-110",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 102,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "        \"TestTrail\":  {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"TestTrail\"\u001b[0m:  {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "            \"Type\" : \"AWS::CloudTrail::Trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m : \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "            \"Properties\" : {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m : {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "                \"IsLogging\" : true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"IsLogging\"\u001b[0m : \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "                \"S3BucketName\" : \"polystudents352-2474842\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"S3BucketName\"\u001b[0m : \u001b[38;5;37m\"polystudents352-2474842\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "                \"TrailName\" : \"polystudent-lab4-trail\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"TrailName\"\u001b[0m : \u001b[38;5;37m\"polystudent-lab4-trail\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "            },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            },",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "            \"DependsOn\": [\"LogPolicy\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"DependsOn\"\u001b[0m: [\u001b[38;5;37m\"LogPolicy\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        }",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0015",
          "AVDID": "AVD-AWS-0015",
          "Title": "CloudTrail should use Customer managed keys to encrypt the logs",
          "Description": "Using AWS managed keys does not allow for fine grained control.  Using Customer managed keys provides comprehensive control over cryptographic keys, enabling management of policies, permissions, and rotation, thus enhancing security and compliance measures for sensitive data and systems.\n",
          "Message": "CloudTrail does not use a customer managed key to encrypt the logs.",
          "Namespace": "builtin.aws.cloudtrail.aws0015",
          "Query": "data.builtin.aws.cloudtrail.aws0015.deny",
          "Resolution": "Use Customer managed key",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0015",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/encrypting-cloudtrail-log-files-with-aws-kms.html",
            "https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html#key-mgmt",
            "https://avd.aquasec.com/misconfig/avd-aws-0015"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3-2.json:102-110",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 102,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "        \"TestTrail\":  {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"TestTrail\"\u001b[0m:  {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "            \"Type\" : \"AWS::CloudTrail::Trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m : \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "            \"Properties\" : {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m : {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "                \"IsLogging\" : true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"IsLogging\"\u001b[0m : \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "                \"S3BucketName\" : \"polystudents352-2474842\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"S3BucketName\"\u001b[0m : \u001b[38;5;37m\"polystudents352-2474842\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "                \"TrailName\" : \"polystudent-lab4-trail\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"TrailName\"\u001b[0m : \u001b[38;5;37m\"polystudent-lab4-trail\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "            },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            },",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "            \"DependsOn\": [\"LogPolicy\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"DependsOn\"\u001b[0m: [\u001b[38;5;37m\"LogPolicy\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        }",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0016",
          "AVDID": "AVD-AWS-0016",
          "Title": "Cloudtrail log validation should be enabled to prevent tampering of log data",
          "Description": "Illicit activity could be removed from the logs. Log validation should be activated on Cloudtrail logs to prevent the tampering of the underlying data in the S3 bucket. It is feasible that a rogue actor compromising an AWS account might want to modify the log data to remove trace of their actions.\n",
          "Message": "Trail does not have log validation enabled.",
          "Namespace": "builtin.aws.cloudtrail.aws0016",
          "Query": "data.builtin.aws.cloudtrail.aws0016.deny",
          "Resolution": "Turn on log validation for Cloudtrail",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0016",
          "References": [
            "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-log-file-validation-intro.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0016"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "s3-2.json:102-110",
            "Provider": "AWS",
            "Service": "cloudtrail",
            "StartLine": 102,
            "EndLine": 110,
            "Code": {
              "Lines": [
                {
                  "Number": 102,
                  "Content": "        \"TestTrail\":  {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;37m\"TestTrail\"\u001b[0m:  {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 103,
                  "Content": "            \"Type\" : \"AWS::CloudTrail::Trail\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Type\"\u001b[0m : \u001b[38;5;37m\"AWS::CloudTrail::Trail\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 104,
                  "Content": "            \"Properties\" : {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"Properties\"\u001b[0m : {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 105,
                  "Content": "                \"IsLogging\" : true,",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"IsLogging\"\u001b[0m : \u001b[38;5;166mtrue\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 106,
                  "Content": "                \"S3BucketName\" : \"polystudents352-2474842\",",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"S3BucketName\"\u001b[0m : \u001b[38;5;37m\"polystudents352-2474842\"\u001b[0m,",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 107,
                  "Content": "                \"TrailName\" : \"polystudent-lab4-trail\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "                \u001b[38;5;33m\"TrailName\"\u001b[0m : \u001b[38;5;37m\"polystudent-lab4-trail\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 108,
                  "Content": "            },",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m            },",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 109,
                  "Content": "            \"DependsOn\": [\"LogPolicy\"]",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "            \u001b[38;5;33m\"DependsOn\"\u001b[0m: [\u001b[38;5;37m\"LogPolicy\"\u001b[0m]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 110,
                  "Content": "        }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        }",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    },
    {
      "Target": "s3.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 47,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/cloudformation/2010-05-15/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/cloudwatch/2010-08-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/dynamodb/2012-08-10/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2014-10-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2015-03-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2015-04-15/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2015-10-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2016-04-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2016-09-15/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/ec2/2016-11-15/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/glacier/2012-06-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/iam/2010-05-08/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/s3/2006-03-01/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/sns/2010-03-31/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "venv/Lib/site-packages/boto3/data/sqs/2012-11-05/resources-1.json",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 38,
        "Failures": 0
      }
    },
    {
      "Target": "vpc.yaml",
      "Class": "config",
      "Type": "cloudformation",
      "MisconfSummary": {
        "Successes": 36,
        "Failures": 6
      },
      "Misconfigurations": [
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "IngressSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 204,
            "EndLine": 204,
            "Code": {
              "Lines": [
                {
                  "Number": 194,
                  "Content": "  IngressSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mIngressSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 195,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 204,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 239,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 240,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "IngressSecurityGroup",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 194,
                  "EndLine": 240
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "AVD-AWS-0107",
          "AVDID": "AVD-AWS-0107",
          "Title": "Security groups should not allow unrestricted ingress to SSH or RDP from any IP address.",
          "Description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS\nresources. It is recommended that no security group allows unrestricted ingress access to\nremote server administration ports, such as SSH to port 22 and RDP to port 3389.\n",
          "Message": "Security group rule allows unrestricted ingress from any IP address.",
          "Namespace": "builtin.aws.ec2.aws0107",
          "Query": "data.builtin.aws.ec2.aws0107.deny",
          "Resolution": "Set a more restrictive CIDR range",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0107",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/security-group-rules-reference.html",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-13",
            "https://docs.aws.amazon.com/securityhub/latest/userguide/ec2-controls.html#ec2-14",
            "https://avd.aquasec.com/misconfig/avd-aws-0107"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "IngressSecurityGroup",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 236,
            "EndLine": 236,
            "Code": {
              "Lines": [
                {
                  "Number": 194,
                  "Content": "  IngressSecurityGroup:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mIngressSecurityGroup\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 195,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 236,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 239,
                  "Content": "",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": true,
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 240,
                  "Content": "          CidrIp: 0.0.0.0/0",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m          \u001b[38;5;33mCidrIp\u001b[0m: \u001b[38;5;37m0.0.0.0\u001b[0m/0",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "IngressSecurityGroup",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 194,
                  "EndLine": 240
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PrivateSubnet1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 71,
            "EndLine": 71,
            "Code": {
              "Lines": [
                {
                  "Number": 65,
                  "Content": "  PrivateSubnet1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateSubnet1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 66,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 67,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 68,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 69,
                  "Content": "      AvailabilityZone: !Select [ 0, !GetAZs '' ]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [ 0, !GetAZs '' ]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 70,
                  "Content": "      CidrBlock: !Ref PrivateSubnet1CIDR",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref PrivateSubnet1CIDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 71,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 72,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 73,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 74,
                  "Content": "          Value: !Sub ${EnvironmentName} Private Subnet (AZ1)",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Sub ${EnvironmentName} Private Subnet (AZ1)",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PrivateSubnet1",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 65,
                  "EndLine": 74
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PrivateSubnet2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 82,
            "EndLine": 82,
            "Code": {
              "Lines": [
                {
                  "Number": 76,
                  "Content": "  PrivateSubnet2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPrivateSubnet2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 77,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 78,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 79,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 80,
                  "Content": "      AvailabilityZone: !Select [ 1, !GetAZs '' ]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [ 1, !GetAZs '' ]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 81,
                  "Content": "      CidrBlock: !Ref PrivateSubnet2CIDR",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref PrivateSubnet2CIDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 82,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 83,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 84,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 85,
                  "Content": "          Value: !Sub ${EnvironmentName} Private Subnet (AZ2)",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Sub ${EnvironmentName} Private Subnet (AZ2)",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PrivateSubnet2",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 76,
                  "EndLine": 85
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnet1",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 49,
            "EndLine": 49,
            "Code": {
              "Lines": [
                {
                  "Number": 43,
                  "Content": "  PublicSubnet1:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet1\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 47,
                  "Content": "      AvailabilityZone: !Select [ 0, !GetAZs '' ]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [ 0, !GetAZs '' ]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 48,
                  "Content": "      CidrBlock: !Ref PublicSubnet1CIDR",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref PublicSubnet1CIDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 49,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 50,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "          Value: !Sub ${EnvironmentName} Public Subnet (AZ1)",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Sub ${EnvironmentName} Public Subnet (AZ1)",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet1",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 43,
                  "EndLine": 52
                }
              }
            ]
          }
        },
        {
          "Type": "CloudFormation Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "PublicSubnet2",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 60,
            "EndLine": 60,
            "Code": {
              "Lines": [
                {
                  "Number": 54,
                  "Content": "  PublicSubnet2:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "  \u001b[38;5;33mPublicSubnet2\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 55,
                  "Content": "    Type: AWS::EC2::Subnet",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mType\u001b[0m: AWS::EC2::Subnet",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 56,
                  "Content": "    Properties:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;33mProperties\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 57,
                  "Content": "      VpcId: !Ref VPC",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mVpcId\u001b[0m: !Ref VPC",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 58,
                  "Content": "      AvailabilityZone: !Select [ 1, !GetAZs '' ]",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mAvailabilityZone\u001b[0m: !Select [ 1, !GetAZs '' ]",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 59,
                  "Content": "      CidrBlock: !Ref PublicSubnet2CIDR",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mCidrBlock\u001b[0m: !Ref PublicSubnet2CIDR",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 60,
                  "Content": "      MapPublicIpOnLaunch: true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "      \u001b[38;5;33mMapPublicIpOnLaunch\u001b[0m: \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 61,
                  "Content": "      Tags:",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m      \u001b[38;5;33mTags\u001b[0m:",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 62,
                  "Content": "        - Key: Name",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        - \u001b[38;5;33mKey\u001b[0m: Name",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 63,
                  "Content": "          Value: !Sub ${EnvironmentName} Public Subnet (AZ2)",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "          \u001b[38;5;33mValue\u001b[0m: !Sub ${EnvironmentName} Public Subnet (AZ2)",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "PublicSubnet2",
                "Filename": "vpc.yaml",
                "Location": {
                  "StartLine": 54,
                  "EndLine": 63
                }
              }
            ]
          }
        }
      ]
    }
  ]
}
